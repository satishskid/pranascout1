# 🚀 Pranayama Coach - Production Deployment Guide\n\nThis guide will help you deploy the complete Pranayama Coach application to production, including the backend API and the web dashboard.\n\n## 📋 Quick Start\n\n### Option 1: Automated Script (Recommended)\n\n```bash\n# Make script executable\nchmod +x scripts/deploy.sh\n\n# Run full deployment\n./scripts/deploy.sh full\n```\n\n### Option 2: Manual Steps\n\n1. **Deploy Backend to Railway**\n2. **Deploy Web Dashboard to Netlify**\n3. **Configure GitHub Actions for CI/CD**\n\n## 🏗️ Architecture Overview\n\n```\n┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐\n│   Mobile Apps   │    │  Web Dashboard  │    │   Backend API   │\n│                 │    │                 │    │                 │\n│ • iOS App       │───▶│ • Netlify       │───▶│ • Railway       │\n│ • Android App   │    │ • React Admin   │    │ • Node.js       │\n│ • TestFlight    │    │ • Analytics     │    │ • MongoDB Atlas │\n│ • Google Play   │    │ • User Mgmt     │    │ • Redis         │\n└─────────────────┘    └─────────────────┘    └─────────────────┘\n         │                       │                       │\n         └───────────────────────┼───────────────────────┘\n                                 │\n                    ┌─────────────────┐\n                    │   GitHub        │\n                    │   • CI/CD       │\n                    │   • Automated   │\n                    │   • Testing     │\n                    └─────────────────┘\n```\n\n## 🛠️ Prerequisites\n\n### Required Accounts\n- [GitHub](https://github.com) (for code repository)\n- [Railway](https://railway.app) (for backend hosting)\n- [Netlify](https://netlify.com) (for dashboard hosting)\n- [MongoDB Atlas](https://mongodb.com/cloud/atlas) (for database)\n\n### Required Tools\n- Node.js 18+\n- npm or yarn\n- Git\n- Railway CLI (optional)\n- Netlify CLI (optional)\n\n## 🚀 Deployment Steps\n\n### Step 1: Backend Deployment (Railway)\n\n#### 1.1 Setup MongoDB Atlas\n\n1. Create MongoDB Atlas account\n2. Create a new cluster\n3. Create database user\n4. Get connection string\n5. Whitelist Railway IPs (0.0.0.0/0 for simplicity)\n\n#### 1.2 Deploy to Railway\n\n**Option A: Railway CLI**\n```bash\n# Install Railway CLI\nnpm install -g @railway/cli\n\n# Login to Railway\nrailway login\n\n# Initialize project\ncd backend\nrailway init\n\n# Set environment variables\nrailway variables set MONGODB_URI=\"your_mongodb_connection_string\"\nrailway variables set JWT_SECRET=\"your_jwt_secret\"\nrailway variables set NODE_ENV=\"production\"\n\n# Deploy\nrailway up\n```\n\n**Option B: GitHub Integration**\n1. Connect GitHub repo to Railway\n2. Select backend folder as root\n3. Set environment variables in Railway dashboard\n4. Deploy automatically on push\n\n#### 1.3 Required Environment Variables\n\n```env\n# Database\nMONGODB_URI=mongodb+srv://user:pass@cluster.mongodb.net/pranayama\nREDIS_URL=redis://localhost:6379\n\n# Security\nJWT_SECRET=your-super-secure-jwt-secret\nENCRYPTION_KEY=your-32-character-encryption-key\n\n# Server\nNODE_ENV=production\nPORT=3000\nCORS_ORIGIN=https://your-dashboard-domain.netlify.app\n\n# AWS (Optional)\nAWS_ACCESS_KEY_ID=your_aws_key\nAWS_SECRET_ACCESS_KEY=your_aws_secret\nAWS_REGION=us-east-1\nAWS_S3_BUCKET=pranayama-uploads\n\n# Email (Optional)\nSMTP_HOST=smtp.gmail.com\nSMTP_PORT=587\nSMTP_USER=your_email@gmail.com\nSMTP_PASS=your_app_password\n```\n\n### Step 2: Web Dashboard Deployment (Netlify)\n\n#### 2.1 Build Dashboard\n\n```bash\ncd web-dashboard\n\n# Install dependencies\nnpm install\n\n# Build for production\nnpm run build\n```\n\n#### 2.2 Deploy to Netlify\n\n**Option A: Netlify CLI**\n```bash\n# Install Netlify CLI\nnpm install -g netlify-cli\n\n# Login to Netlify\nnetlify login\n\n# Deploy\nnetlify deploy --prod --dir=build\n```\n\n**Option B: GitHub Integration**\n1. Connect GitHub repo to Netlify\n2. Set build settings:\n   - Base directory: `web-dashboard`\n   - Build command: `npm run build`\n   - Publish directory: `web-dashboard/build`\n3. Set environment variables\n4. Deploy automatically on push\n\n#### 2.3 Configure Netlify Settings\n\n**Build Settings:**\n```\nBase directory: web-dashboard\nBuild command: npm run build\nPublish directory: web-dashboard/build\nNode version: 18\n```\n\n**Environment Variables:**\n```\nREACT_APP_API_URL=/api\nREACT_APP_ENVIRONMENT=production\nREACT_APP_APP_NAME=Pranayama Coach Admin\nREACT_APP_VERSION=1.0.0\n```\n\n**Custom Headers (in netlify.toml):**\n```toml\n# Security headers are already configured\n# API proxy is already configured\n# See web-dashboard/netlify.toml for details\n```\n\n### Step 3: GitHub Actions CI/CD\n\n#### 3.1 Required GitHub Secrets\n\nGo to GitHub repository → Settings → Secrets and variables → Actions:\n\n```\n# Railway\nRAILWAY_PROJECT_ID=your_railway_project_id\nRAILWAY_TOKEN=your_railway_token\n\n# Netlify\nNETLIFY_AUTH_TOKEN=your_netlify_auth_token\nNETLIFY_SITE_ID=your_netlify_site_id\n\n# Mobile App Store (Optional)\nAPPLE_ID_USERNAME=your_apple_id\nAPPLE_ID_PASSWORD=your_app_specific_password\nANDROID_KEYSTORE_PASSWORD=your_keystore_password\nGOOGLE_PLAY_SERVICE_ACCOUNT=your_service_account_json\n\n# API Configuration\nPRODUCTION_API_URL=/api\nTEST_MONGODB_URI=mongodb://localhost:27017/test\n```\n\n#### 3.2 Workflow Triggers\n\nThe GitHub Actions workflow will automatically:\n- Run tests on every push and PR\n- Deploy backend to Railway on main branch\n- Deploy dashboard to Netlify on main branch\n- Build mobile apps for app stores\n- Send deployment notifications\n\n## 🔧 Configuration\n\n### Backend Configuration\n\n**Key files:**\n- `backend/.env.production` - Production environment variables\n- `backend/railway.json` - Railway deployment config\n- `backend/Dockerfile` - Container configuration\n\n### Dashboard Configuration\n\n**Key files:**\n- `web-dashboard/.env.production` - Production environment\n- `web-dashboard/netlify.toml` - Netlify configuration\n- `web-dashboard/package.json` - Build scripts\n\n## 🔍 Monitoring & Maintenance\n\n### Health Checks\n\n**Backend Health:**\n```bash\ncurl https://your-backend.up.railway.app/health\n```\n\n**Dashboard Health:**\n```bash\ncurl https://your-dashboard.netlify.app\n```\n\n### Logs\n\n**Railway Logs:**\n```bash\nrailway logs\n```\n\n**Netlify Logs:**\n- Check in Netlify dashboard → Deploys\n\n### Updates\n\n**Automatic Updates:**\n- Push to main branch triggers deployment\n- GitHub Actions handles testing and deployment\n\n**Manual Updates:**\n```bash\n# Update dependencies\nnpm update\n\n# Run deployment script\n./scripts/deploy.sh full\n```\n\n## 🔒 Security\n\n### Environment Variables\n- Never commit secrets to Git\n- Use platform-specific environment variable systems\n- Rotate secrets regularly\n\n### HTTPS/SSL\n- Railway provides automatic HTTPS\n- Netlify provides automatic SSL certificates\n- Force HTTPS redirects are enabled\n\n### CORS\n- Configure CORS origins in backend\n- Whitelist only your dashboard domain\n\n## 🚨 Troubleshooting\n\n### Common Issues\n\n**Build Failures:**\n```bash\n# Clear node modules and reinstall\nrm -rf node_modules package-lock.json\nnpm install\n\n# Check Node.js version\nnode --version  # Should be 18+\n```\n\n**API Connection Issues:**\n1. Check backend deployment status\n2. Verify environment variables\n3. Check CORS configuration\n4. Test API endpoints directly\n\n**Authentication Issues:**\n1. Verify JWT secret consistency\n2. Check token expiration\n3. Clear browser storage\n\n### Getting Help\n\n1. **Check logs first:**\n   - Railway dashboard for backend logs\n   - Netlify dashboard for build logs\n   - Browser console for frontend errors\n\n2. **Test components separately:**\n   - Test backend API with Postman\n   - Test frontend build locally\n   - Check database connections\n\n3. **Common commands:**\n```bash\n# Test backend locally\ncd backend && npm start\n\n# Test dashboard locally\ncd web-dashboard && npm start\n\n# Check deployment status\n./scripts/deploy.sh help\n```\n\n## 📱 Mobile App Deployment\n\nThe repository includes configurations for building and deploying mobile apps to app stores. See:\n\n- `app-store/ios/AppStoreMetadata.md` - iOS App Store listing\n- `app-store/android/PlayStoreMetadata.md` - Google Play Store listing\n- `.github/workflows/deploy.yml` - Automated builds\n\n## ✅ Post-Deployment Checklist\n\n- [ ] Backend deployed and accessible\n- [ ] Database connected and functional\n- [ ] Dashboard deployed and accessible\n- [ ] Authentication working\n- [ ] API proxy configured correctly\n- [ ] SSL certificates active\n- [ ] Monitoring set up\n- [ ] Backup strategy in place\n- [ ] Team access configured\n- [ ] Documentation updated\n\n## 🎯 Next Steps\n\nAfter successful deployment:\n\n1. **Set up monitoring** (Uptime Robot, etc.)\n2. **Configure alerts** for critical issues\n3. **Plan backup strategy** for database\n4. **Set up staging environment** for testing\n5. **Document operational procedures**\n6. **Train your team** on the admin dashboard\n\n---\n\n**Need help?** Check the detailed guides:\n- [Netlify Deployment Guide](docs/NETLIFY_DEPLOYMENT.md)\n- [Architecture Documentation](docs/ARCHITECTURE.md)\n- [Setup Guide](docs/SETUP_GUIDE.md)\n\nYour Pranayama Coach application is now ready for production! 🎉